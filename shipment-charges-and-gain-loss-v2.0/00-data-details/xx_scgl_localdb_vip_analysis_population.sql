USE scgl;

SELECT 
    bob_id_sales_order_item,
    sc_sales_order_item,
    order_nr,
    payment_method,
    sku,
    primary_category,
    bob_id_supplier,
    short_code,
    seller_name,
    seller_type,
    tax_class,
    unit_price,
    paid_price,
    shipping_amount,
    shipping_surcharge,
    shipping_fee_to_customer,
    marketplace_commission_fee,
    coupon_money_value,
    cart_rule_discount,
    coupon_code,
    coupon_type,
    cart_rule_display_names,
    last_status,
    order_date,
    first_shipped_date,
    last_shipped_date,
    delivered_date,
    not_delivered_date,
    closed_date,
    refund_completed_date,
    pickup_provider_type,
    package_number,
    id_package_dispatching,
    invoice_tracking_number,
    invoice_shipment_provider,
    first_tracking_number,
    first_shipment_provider,
    last_tracking_number,
    last_shipment_provider,
    origin,
    city,
    id_district,
    config_length,
    config_width,
    config_height,
    config_weight,
    simple_length,
    simple_width,
    simple_height,
    simple_weight,
    shipping_type,
    delivery_type,
    is_marketplace,
    is_express_shipping,
    fast_delivery,
    retail_cogs,
    payment_cost_logic,
    sc_fee_1,
    sc_fee_2,
    sc_fee_3,
    qty,
    formula_weight,
    rounded_weight,
    chargeable_weight,
    rounded_chargeable_weight,
    chargeable_qty,
    fk_campaign,
    campaign,
    fk_rate_card_scheme,
    rate_card_scheme,
    fk_shipment_scheme,
    shipment_scheme,
    fk_zone_type,
    zone_type,
    shipment_fee_mp_seller_rate,
    shipment_fee_mp_seller,
    sel_ins_fee,
    sel_ins_fee_vat,
    total_insurance_fee,
    total_shipment_fee_mp_seller,
    shipment_cost_rate,
    shipment_cost_discount,
    shipment_cost_vat,
    total_shipment_cost,
    pickup_cost,
    pickup_cost_discount,
    pickup_cost_vat,
    total_pickup_cost,
    insurance_rate,
    insurance_vat,
    sp_ins_charge,
    sp_ins_charge_vat,
    total_insurance_charge,
    total_delivery_cost,
    gain_loss
FROM
    (SELECT 
        ac.*,
            ac.total_shipment_fee_mp_seller + ac.shipping_fee_to_customer - ac.total_delivery_cost 'gain_loss'
    FROM
        scgl.campaign_tracker ct
    LEFT JOIN scgl.anondb_calculate ac ON ct.bob_id_supplier = ac.bob_id_supplier
    WHERE
        ct.end_date > NOW()
            AND ct.fk_campaign IN (2)
            AND ct.bob_id_supplier IN ()
            AND ac.fk_shipment_scheme IN (1 , 2, 3, 4, 7)
            AND ac.rounded_weight <= 400) master_account;