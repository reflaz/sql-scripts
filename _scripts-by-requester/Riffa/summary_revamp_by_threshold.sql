SET @kab_gianyar = '7103,7102,7101,7100,7099,7098,7097';
SET @kab_gunung_kidul = '6703,6702,6701,6700,6699,6698,6697,6696,6695,6694,6693,6692,6691,6690,6689,6688,6687,6686';
SET @kab_tasikmalaya = '5786,5785,5784,5783,5782,5781,5780,5779,5778,5777,5776,5775,5774,5773,5772,5771,5770,5769,5768,5767,5766,5765,5764,5763,5762,5761,5760,5759,5758,5757,5756,5755,5754,5753,5752,5751,5750,5749,5748';
SET @kab_jember = '4935,4934,4933,4932,4931,4930,4929,17242,4928,4927,4926,4925,4924,4923,4922,4921,4920,4919,4918,4917,4916,4915,4914,4913,4912,4911,4910,4909,4908,4907,4906,4905';
SET @kab_mojokerto = '4735,4734,4733,4732,4731,4730,4729,4728,4727,4726,17240,4725,4724,4723,4722,4721,4720,4719,4718';
SET @kota_kediri = '5130,5129,5128';
SET @kota_madiun = '5126,17249,5125,5124';
SET @kota_mojokerto = '5116,5115';
SET @kota_pasuruan = '5113,5112,17247,5111';
SET @kota_probolinggo = '5109,17245,17246,5108,5107';
SET @kab_lampung_selatan = '3704,3703,3702,3701,3700,3699,3698,3697,3696,3695,3694,3693,3692,3691,3690,3689,3688';
SET @kab_gowa = '1746,1745,1744,1743,1742,1741,1740,1739,1738,1737,1736,1735,1734,1733,1732,17483,1731,1730,1729';
SET @kab_maros = '1669,1667,1666,1665,1664,1663,17480,1662,1668,1661,1660,1659,1658,1657,1656';
SET @kab_bantul = '6721,6720,6719,6718,6717,6716,6715,6714,6713,6712,6711,6710,6709,6708,6707,6706,6705';
SET @kab_kulon_progo = '6684,6683,6682,6681,6680,6679,6678,6677,6676,6675,6674,6673';
SET @kota_cirebon = '17386,17387,6333,6332,6331,6330,6329';
SET @kota_sukabumi = '6320,6319,6318,6317,6316,6315,6314';
SET @kota_tasikmalaya = '6312,6311,6310,6309,6308,6307,6306,6305,6304,17383,6303';
SET @kota_pekanbaru = '2072,2071,2070,17229,2069,2068,2067,2066,2065,2064,2063,2062,2061';
SET @kota_padang = '981,980,979,978,977,976,975,17347,974,973,972,971';
SET @kota_palembang = '790,789,788,787,786,785,784,783,782,781,17370,780,779,778,777,776,775';
SET @kota_makassar = '1845,1844,1843,1842,1841,1840,1839,1838,1837,1836,1835,1834,1833,1832';
SET @kab_badung = '7125,17315,7124,7123,7122,17316,7121,17317,17318,7120,17319';
SET @kota_denpasar = '7130,7129,7128,7127';
SET @kab_lebak = '6979,6978,6977,6976,6975,6974,6973,6972,6971,6970,6969,6968,6967,6966,6965,6964,6963,6962,6961,6960,6959,6958,6957,6956,6955,6954,6953,6952';
SET @kab_pandeglang = '6950,6949,6948,17392,6947,6946,6945,6944,6943,6942,6941,6940,6939,6938,6937,6936,6935,6934,6933,6932,6931,6930,6929,6928,6927,6926,6925,6924,6923,6922,6921,6920,6919,6918,6917,6916';
SET @kab_serang = '6914,6913,6912,6911,6910,6909,6908,6907,6906,6905,6904,6903,6902,6901,6900,6899,6898,6897,6896,6895,6894,6893,6892,6891,6890,6889,6888,6887';
SET @kota_cilegon = '7017,7016,7015,7014,7013,7012,17394,7011,7010';
SET @kota_serang = '7008,7007,7006,7005,7004,7003';
SET @kab_sleman = '6671,6670,6669,6668,6667,6666,6665,6664,6663,6662,6661,6660,6659,6658,6657,6656,6655';
SET @kota_yogyakarta = '6736,6735,6734,6733,6732,6731,6730,6729,6728,6727,6726,6725,6724,6723,17212';
SET @kab_bandung = '6301,6300,6299,6298,6297,6296,6295,6294,6293,6292,6291,6290,6289,6288,6287,6286,6285,6284,6283,6282,6281,6280,6279,6278,6277,6276,6275,6274,6273,6272,6271';
SET @kab_bandung_barat = '6269,6268,6267,6266,17382,6265,6264,6263,6262,6261,6260,6259,6258,6257,6256,6255';
SET @kota_bandung = '6393,6392,6391,6390,6389,6388,17391,6387,6386,6385,6384,6383,6382,6381,6380,6379,6378,6377,6376,6375,6374,6373,6372,6371,6370,6369,6368,6367,6366,6365,6364';
SET @kab_semarang = '5274,5273,5272,5271,5270,5269,5268,5267,5266,5265,5264,5263,5262,5261,5260,5259,5258,17493,5257,5256';
SET @kota_semarang = '5732,5731,5730,5729,5728,5727,5726,5725,5724,17506,5723,5722,5721,5720,5719,5718,5717';
SET @kota_surakarta_solo = '5715,5714,5713,5712,5711,17505';
SET @kab_bangkalan = '5073,17244,5072,5071,5070,5069,5068,5067,5066,5065,5064,5063,5062,5061,5060,5059,5058,5057,5056';
SET @kab_bojonegoro = '5006,5005,5004,5003,5002,5001,5000,4999,4998,4997,4996,4995,4994,4993,4992,4991,4990,4989,4988,4987,4986,4985,4984,4983,4982,4981,4980';
SET @kab_gresik = '4954,4953,4952,4951,4950,4949,4948,4947,4946,4945,4944,4943,4942,4941,4940,4939,4938,4937';
SET @kab_jombang = '4903,4902,4901,4900,4899,4898,4897,4896,4895,4894,4893,4892,4891,4890,4889,4888,4887,4886,4885,4884,4883';
SET @kab_kediri = '4881,4880,4879,4878,4877,4876,4875,4874,4873,4872,4871,4870,4869,4868,4867,4866,4865,4864,4863,4862,4861,4860,4859,4858,4857,4856';
SET @kab_lamongan = '4854,4853,4852,4851,4850,4849,4848,4847,4846,4845,4844,4843,4842,4841,4840,4839,4838,4837,4836,4835,4834,4833,4832,4831,4830,4829,4828';
SET @kab_lumajang = '4826,4825,4824,4823,4822,4821,4820,4819,4818,4817,4816,4815,4814,4813,4812,4811,4810,4809,4808,4807,4806';
SET @kab_madiun = '4804,17241,4803,4802,4801,4800,4799,4798,4797,4796,4795,4794,4793,4792,4791,4790';
SET @kab_nganjuk = '4716,4715,4714,4713,4712,4711,4710,4709,4708,4707,4706,4705,4704,4703,4702,4701,4700,4699,4698,4697';
SET @kab_pamekasan = '4662,4661,4660,4659,4658,4657,17238,4656,4655,4654,4653,4652,4651,4650';
SET @kab_pasuruan = '4648,4647,4646,4645,4644,17236,4643,4642,4641,4640,4639,17237,4638,4637,4636,4635,4634,4633,4632,4631,4630,4629,4628,4627,4626,4625';
SET @kab_probolinggo = '4601,4600,4599,4598,4597,4596,4595,4594,4593,4592,4591,4590,4589,4588,4587,4586,4585,17235,4584,4583,4582,4581,4580,4579,4578';
SET @kab_sampang = '4576,4575,4574,4573,4572,4571,4570,4569,4568,4567,4566,4565,4564,4563';
SET @kab_sidoarjo = '4561,4560,4559,4558,4557,4556,4555,4554,4553,4552,4551,4550,4549,4548,4547,4546,4545,4544';
SET @kab_trenggalek = '4496,4495,4494,4493,4492,4491,4490,4489,4488,4487,4486,4485,4484,4483';
SET @kab_tuban = '4481,4480,4479,4478,4477,4476,4475,4474,4473,4472,4471,17232,4470,4469,4468,4467,4466,4465,4464,4463,4462';
SET @kab_tulungagung = '4460,4459,4458,4457,4456,4455,4454,4453,4452,4451,4450,4449,4448,4447,4446,4445,4444,4443,4442';
SET @kota_malang = '5122,5121,5120,5119,17248,5118';
SET @kota_surabaya = '5105,5104,5103,5102,5101,5100,5099,5098,5097,5096,5095,5094,5093,5092,5091,5090,5089,5088,5087,5086,5085,5084,5083,5082,5081,5080,5079,5078,5077,5076,5075';
SET @kota_balikpapan = '17259,3955,3954,3953,3952,3951';
SET @kota_samarinda = '3945,17629,3944,3943,3942,3941,3940';
SET @kota_bandar_lampung = '17211,3742,3741,3740,3739,3738,3737,3736,3735,3734,3733,3732,3731,3730';
SET @kab_tapanuli_tengah = '195,194,193,192,191,190,189,188,187,186,185,184,17410,183,182,181,180,179,178,177,176';
SET @kota_medan = '17443,565,564,563,562,561,560,559,558,557,556,555,554,553,552,551,550,549,548,547,546,545';

SET @all_dist = '7103,7102,7101,7100,7099,7098,7097,6703,6702,6701,6700,6699,6698,6697,6696,6695,6694,6693,6692,6691,6690,6689,6688,6687,6686,5786,5785,5784,5783,5782,5781,5780,5779,5778,5777,5776,5775,5774,5773,5772,5771,5770,5769,5768,5767,5766,5765,5764,5763,5762,5761,5760,5759,5758,5757,5756,5755,5754,5753,5752,5751,5750,5749,5748,4935,4934,4933,4932,4931,4930,4929,17242,4928,4927,4926,4925,4924,4923,4922,4921,4920,4919,4918,4917,4916,4915,4914,4913,4912,4911,4910,4909,4908,4907,4906,4905,4735,4734,4733,4732,4731,4730,4729,4728,4727,4726,17240,4725,4724,4723,4722,4721,4720,4719,4718,5130,5129,5128,5126,17249,5125,5124,5116,5115,5113,5112,17247,5111,5109,17245,17246,5108,5107,3704,3703,3702,3701,3700,3699,3698,3697,3696,3695,3694,3693,3692,3691,3690,3689,3688,1746,1745,1744,1743,1742,1741,1740,1739,1738,1737,1736,1735,1734,1733,1732,17483,1731,1730,1729,1669,1667,1666,1665,1664,1663,17480,1662,1668,1661,1660,1659,1658,1657,1656,6721,6720,6719,6718,6717,6716,6715,6714,6713,6712,6711,6710,6709,6708,6707,6706,6705,6684,6683,6682,6681,6680,6679,6678,6677,6676,6675,6674,6673,17386,17387,6333,6332,6331,6330,6329,6320,6319,6318,6317,6316,6315,6314,6312,6311,6310,6309,6308,6307,6306,6305,6304,17383,6303,2072,2071,2070,17229,2069,2068,2067,2066,2065,2064,2063,2062,2061,981,980,979,978,977,976,975,17347,974,973,972,971,790,789,788,787,786,785,784,783,782,781,17370,780,779,778,777,776,775,1845,1844,1843,1842,1841,1840,1839,1838,1837,1836,1835,1834,1833,1832,7125,17315,7124,7123,7122,17316,7121,17317,17318,7120,17319,7130,7129,7128,7127,6979,6978,6977,6976,6975,6974,6973,6972,6971,6970,6969,6968,6967,6966,6965,6964,6963,6962,6961,6960,6959,6958,6957,6956,6955,6954,6953,6952,6950,6949,6948,17392,6947,6946,6945,6944,6943,6942,6941,6940,6939,6938,6937,6936,6935,6934,6933,6932,6931,6930,6929,6928,6927,6926,6925,6924,6923,6922,6921,6920,6919,6918,6917,6916,6914,6913,6912,6911,6910,6909,6908,6907,6906,6905,6904,6903,6902,6901,6900,6899,6898,6897,6896,6895,6894,6893,6892,6891,6890,6889,6888,6887,7017,7016,7015,7014,7013,7012,17394,7011,7010,7008,7007,7006,7005,7004,7003,6671,6670,6669,6668,6667,6666,6665,6664,6663,6662,6661,6660,6659,6658,6657,6656,6655,6736,6735,6734,6733,6732,6731,6730,6729,6728,6727,6726,6725,6724,6723,17212,6301,6300,6299,6298,6297,6296,6295,6294,6293,6292,6291,6290,6289,6288,6287,6286,6285,6284,6283,6282,6281,6280,6279,6278,6277,6276,6275,6274,6273,6272,6271,6269,6268,6267,6266,17382,6265,6264,6263,6262,6261,6260,6259,6258,6257,6256,6255,6393,6392,6391,6390,6389,6388,17391,6387,6386,6385,6384,6383,6382,6381,6380,6379,6378,6377,6376,6375,6374,6373,6372,6371,6370,6369,6368,6367,6366,6365,6364,5274,5273,5272,5271,5270,5269,5268,5267,5266,5265,5264,5263,5262,5261,5260,5259,5258,17493,5257,5256,5732,5731,5730,5729,5728,5727,5726,5725,5724,17506,5723,5722,5721,5720,5719,5718,5717,5715,5714,5713,5712,5711,17505,5073,17244,5072,5071,5070,5069,5068,5067,5066,5065,5064,5063,5062,5061,5060,5059,5058,5057,5056,5006,5005,5004,5003,5002,5001,5000,4999,4998,4997,4996,4995,4994,4993,4992,4991,4990,4989,4988,4987,4986,4985,4984,4983,4982,4981,4980,4954,4953,4952,4951,4950,4949,4948,4947,4946,4945,4944,4943,4942,4941,4940,4939,4938,4937,4903,4902,4901,4900,4899,4898,4897,4896,4895,4894,4893,4892,4891,4890,4889,4888,4887,4886,4885,4884,4883,4881,4880,4879,4878,4877,4876,4875,4874,4873,4872,4871,4870,4869,4868,4867,4866,4865,4864,4863,4862,4861,4860,4859,4858,4857,4856,4854,4853,4852,4851,4850,4849,4848,4847,4846,4845,4844,4843,4842,4841,4840,4839,4838,4837,4836,4835,4834,4833,4832,4831,4830,4829,4828,4826,4825,4824,4823,4822,4821,4820,4819,4818,4817,4816,4815,4814,4813,4812,4811,4810,4809,4808,4807,4806,4804,17241,4803,4802,4801,4800,4799,4798,4797,4796,4795,4794,4793,4792,4791,4790,4716,4715,4714,4713,4712,4711,4710,4709,4708,4707,4706,4705,4704,4703,4702,4701,4700,4699,4698,4697,4662,4661,4660,4659,4658,4657,17238,4656,4655,4654,4653,4652,4651,4650,4648,4647,4646,4645,4644,17236,4643,4642,4641,4640,4639,17237,4638,4637,4636,4635,4634,4633,4632,4631,4630,4629,4628,4627,4626,4625,4601,4600,4599,4598,4597,4596,4595,4594,4593,4592,4591,4590,4589,4588,4587,4586,4585,17235,4584,4583,4582,4581,4580,4579,4578,4576,4575,4574,4573,4572,4571,4570,4569,4568,4567,4566,4565,4564,4563,4561,4560,4559,4558,4557,4556,4555,4554,4553,4552,4551,4550,4549,4548,4547,4546,4545,4544,4496,4495,4494,4493,4492,4491,4490,4489,4488,4487,4486,4485,4484,4483,4481,4480,4479,4478,4477,4476,4475,4474,4473,4472,4471,17232,4470,4469,4468,4467,4466,4465,4464,4463,4462,4460,4459,4458,4457,4456,4455,4454,4453,4452,4451,4450,4449,4448,4447,4446,4445,4444,4443,4442,5122,5121,5120,5119,17248,5118,5105,5104,5103,5102,5101,5100,5099,5098,5097,5096,5095,5094,5093,5092,5091,5090,5089,5088,5087,5086,5085,5084,5083,5082,5081,5080,5079,5078,5077,5076,5075,17259,3955,3954,3953,3952,3951,3945,17629,3944,3943,3942,3941,3940,17211,3742,3741,3740,3739,3738,3737,3736,3735,3734,3733,3732,3731,3730,195,194,193,192,191,190,189,188,187,186,185,184,17410,183,182,181,180,179,178,177,176,17443,565,564,563,562,561,560,559,558,557,556,555,554,553,552,551,550,549,548,547,546,545';


SELECT 
    city,
    threshold_remarks,
    SUM(count_soi) 'count_soi',
    SUM(total_paid_price) 'total_paid_price',
    SUM(total_shipping_charge) 'total_shipping_charge'
FROM
    (SELECT 
        city,
            COUNT(bob_id_sales_order_item) 'count_soi',
            SUM(unit_price) 'total_unit_price',
            SUM(paid_price) 'total_paid_price',
            SUM(shipping_charge) 'total_shipping_charge',
            CASE
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_gianyar) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_gunung_kidul) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_tasikmalaya) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_jember) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_mojokerto) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_kediri) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_madiun) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_mojokerto) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_pasuruan) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_probolinggo) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_lampung_selatan) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_gowa) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_maros) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_bantul) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_kulon_progo) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_cirebon) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_sukabumi) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_tasikmalaya) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_pekanbaru) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_padang) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_palembang) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_makassar) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_badung) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_denpasar) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_lebak) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_pandeglang) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_serang) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_cilegon) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_serang) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_sleman) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_yogyakarta) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_bandung) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_bandung_barat) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_bandung) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_semarang) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_semarang) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_surakarta_solo) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_bangkalan) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_bojonegoro) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_gresik) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_jombang) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_kediri) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_lamongan) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_lumajang) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_madiun) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_nganjuk) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_pamekasan) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_pasuruan) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_probolinggo) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_sampang) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_sidoarjo) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_trenggalek) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_tuban) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_tulungagung) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_malang) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_surabaya) AND SUM(unit_price) >= 50000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_balikpapan) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_samarinda) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_bandar_lampung) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kab_tapanuli_tengah) AND SUM(unit_price) >= 100000 THEN 'Equal or higher than threshold'
				WHEN FIND_IN_SET(fk_customer_address_region, @kota_medan) AND SUM(unit_price) >= 75000 THEN 'Equal or higher than threshold'
                ELSE 'Below threshold'
            END 'threshold_remarks'
    FROM
        (SELECT 
        so.id_sales_order,
            city,
            soi.bob_id_sales_order_item,
            soi.unit_price,
            soi.paid_price,
            soi.shipping_amount + soi.shipping_surcharge 'shipping_charge',
            so.fk_customer_address_region,
            CASE
                WHEN soish.created_at IS NULL THEN 0
                WHEN sel.tax_class = 1 THEN 0
                WHEN soi.delivery_type = 'digital' THEN 0
                WHEN sp.shipment_provider_name = 'Digital Delivery' THEN 0
                ELSE 1
            END 'pass'
    FROM
        (SELECT 
        so.id_sales_order, city.name 'city', soa.fk_customer_address_region
    FROM
        oms_live.ims_sales_order so
    LEFT JOIN oms_live.ims_sales_order_address soa ON so.fk_sales_order_address_shipping = soa.id_sales_order_address
    LEFT JOIN oms_live.ims_customer_address_region dist ON soa.fk_customer_address_region = dist.id_customer_address_region
    LEFT JOIN oms_live.ims_customer_address_region city ON dist.fk_customer_address_region = city.id_customer_address_region
    WHERE
        so.created_at >= '2016-03-01'
            AND so.created_at < '2016-04-01'
            AND FIND_IN_SET(soa.fk_customer_address_region, @all_dist)) so
    LEFT JOIN oms_live.ims_sales_order_item soi ON so.id_sales_order = soi.fk_sales_order
    LEFT JOIN oms_live.ims_sales_order_item_status_history soish ON soi.id_sales_order_item = soish.fk_sales_order_item
        AND soish.fk_sales_order_item_status = 67
    LEFT JOIN oms_live.oms_package_item pi ON soi.id_sales_order_item = pi.fk_sales_order_item
    LEFT JOIN oms_live.oms_package pck ON pi.fk_package = pck.id_package
    LEFT JOIN oms_live.oms_package_dispatching pd ON pck.id_package = pd.fk_package
    LEFT JOIN oms_live.oms_shipment_provider sp ON pd.fk_shipment_provider = sp.id_shipment_provider
    LEFT JOIN bob_live.supplier sup ON soi.bob_id_supplier = sup.id_supplier
    LEFT JOIN asc_live.seller sel ON sup.id_supplier = sel.src_id
    HAVING pass = 1) result
    GROUP BY id_sales_order) result
GROUP BY city, threshold_remarks